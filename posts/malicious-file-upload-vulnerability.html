<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Im Yudhi | Malicious file upload vulnerability</title>
    <link rel="stylesheet" href="https://imyudhi.com/css/style.css">
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
</head>
<body>
    <div class="container">
        <h2 class="thick-underline ms-1 ">
            <b>Web security</b> : Malicious file upload vulnerability
        </h2>
        <ul>
            <li>
                Every website which is made with backend frameworks like Laravel, Django & many others can be easily <b>Hacked</b> by this vulnerability.
            </li>
            <li>
                If your site have file upload form then Hacker can upload a file with executable extension like .php, .py, .bat to your site.
            </li>
            <li>
                In that file they can write any code which can be executed  by simply going to url like "example.com/files/test.php"
            </li>
            <li>
                By doing this hacker can get your all confidential files like api keys files or even can get your servers access & delete the whole database or files.
            </li>
            <li>
                To <b>prevent</b> this type of attacks there are some way as following.
            </li>
            <li>
                In file upload code check & block executable file extensions like .php, .py etc.
            </li>
            <li>
                Even if you block file upload by checking extensions hacker can use tools to change file extension & bypass this check.
            </li>
            <li>
                Change uploaded files permission to readonly so even if file gets uploaded it can't be executed.
            </li>
            <li>
                Prevent direct access to your uploads directory. It can be achieved by htaccess files or your server settings.
                If you are using Laravel then you should upload your all project files outside public_html/www folder & store uploaded file to storage directory.
            </li>
            <li>
                Create routes to serve your files. upload files in a different directory like uploads and save filename without extension in database with random generated name.
            </li>
            <li>
                So even if hacker uploads file like "test.php" it will be saved as  "1245abc545"
            </li>
            <li>
                Then create specific routes for specific features like if you have profile images upload system then create route like this
                /profile_images/{file_name}
            </li>
            <li>
                Now in controller / function check if file with given name is available in your private uploads folder.
                then return file with <b>Content-Type: image/png</b>.
                This way even if its an php file or other file it will be executed as Image file.
                So its code will not be executed.
            </li>
            <li>
                This way you can prevent this vulnerability.
            </li>
        </ul>
    </div>
    <div id="bottom">

    </div>
    <script>
         htmx.ajax('GET', '/', {target:'#bottom', swap:'outerHTML'})
    </script>
</body>
</html>